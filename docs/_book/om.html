<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Mathematical description of the Operating model (OM) | FishSimGTG: Population dynamics simulation framework</title>
  <meta name="description" content="This document includes the description of FishSimGTG" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Mathematical description of the Operating model (OM) | FishSimGTG: Population dynamics simulation framework" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This document includes the description of FishSimGTG" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Mathematical description of the Operating model (OM) | FishSimGTG: Population dynamics simulation framework" />
  
  <meta name="twitter:description" content="This document includes the description of FishSimGTG" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="om-pop.html"/>
<link rel="next" href="customized-management-procedures-mps.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">This document includes the description of FishSimGTG</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> What is FishSimGTG?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#installation-and-required-packages"><i class="fa fa-check"></i><b>1.1</b> Installation and required packages</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#how-to-use-fishsimgtg"><i class="fa fa-check"></i><b>1.2</b> How to use FishSimGTG?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="om-pop.html"><a href="om-pop.html"><i class="fa fa-check"></i><b>2</b> How to Populate the Operating Model (OM)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="om-pop.html"><a href="om-pop.html#life-history-object"><i class="fa fa-check"></i><b>2.1</b> Life history object</a></li>
<li class="chapter" data-level="2.2" data-path="om-pop.html"><a href="om-pop.html#fishery-object"><i class="fa fa-check"></i><b>2.2</b> Fishery object</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="om-pop.html"><a href="om-pop.html#selectivity-or-vulnerability"><i class="fa fa-check"></i><b>2.2.1</b> Selectivity or vulnerability</a></li>
<li class="chapter" data-level="2.2.2" data-path="om-pop.html"><a href="om-pop.html#retention"><i class="fa fa-check"></i><b>2.2.2</b> Retention</a></li>
<li class="chapter" data-level="2.2.3" data-path="om-pop.html"><a href="om-pop.html#discard-mortality-rate"><i class="fa fa-check"></i><b>2.2.3</b> Discard mortality rate</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="om-pop.html"><a href="om-pop.html#time-area-object"><i class="fa fa-check"></i><b>2.3</b> Time area object</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="om-pop.html"><a href="om-pop.html#lh-sel"><i class="fa fa-check"></i><b>2.3.1</b> Exploring the Parameterization of the Operating Model So Far</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="om-pop.html"><a href="om-pop.html#stochastic-object"><i class="fa fa-check"></i><b>2.4</b> Stochastic object</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="om-pop.html"><a href="om-pop.html#adding-stochasticity-to-the-lifehistoryobj-object"><i class="fa fa-check"></i><b>2.4.1</b> Adding stochasticity to the <code>LifeHistoryObj</code> object</a></li>
<li class="chapter" data-level="2.4.2" data-path="om-pop.html"><a href="om-pop.html#adding-stochasticity-to-the-histfisheryobj-object"><i class="fa fa-check"></i><b>2.4.2</b> Adding stochasticity to the <code>HistFisheryObj</code> object</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="om-pop.html"><a href="om-pop.html#fishery-projections"><i class="fa fa-check"></i><b>2.5</b> Fishery projections</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="om-pop.html"><a href="om-pop.html#adding-stochasticity-to-the-fishery-projections"><i class="fa fa-check"></i><b>2.5.1</b> Adding stochasticity to the fishery projections</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="om-pop.html"><a href="om-pop.html#the-management-strategy"><i class="fa fa-check"></i><b>2.6</b> The management strategy</a></li>
<li class="chapter" data-level="2.7" data-path="om-pop.html"><a href="om-pop.html#running-the-projection-and-management-strategy-simulation"><i class="fa fa-check"></i><b>2.7</b> Running the projection and management strategy simulation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="om.html"><a href="om.html"><i class="fa fa-check"></i><b>3</b> Mathematical description of the Operating model (OM)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="om.html"><a href="om.html#population-dynamics"><i class="fa fa-check"></i><b>3.1</b> Population dynamics</a></li>
<li class="chapter" data-level="3.2" data-path="om.html"><a href="om.html#life-history"><i class="fa fa-check"></i><b>3.2</b> Life history</a></li>
<li class="chapter" data-level="3.3" data-path="om.html"><a href="om.html#initial-conditions"><i class="fa fa-check"></i><b>3.3</b> Initial conditions</a></li>
<li class="chapter" data-level="3.4" data-path="om.html"><a href="om.html#fishery-dynamics"><i class="fa fa-check"></i><b>3.4</b> Fishery dynamics</a></li>
<li class="chapter" data-level="3.5" data-path="om.html"><a href="om.html#observation-and-monitoring"><i class="fa fa-check"></i><b>3.5</b> Observation and monitoring</a></li>
<li class="chapter" data-level="3.6" data-path="om.html"><a href="om.html#growth-type-group"><i class="fa fa-check"></i><b>3.6</b> Growth-type group</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="customized-management-procedures-mps.html"><a href="customized-management-procedures-mps.html"><i class="fa fa-check"></i><b>4</b> Customized Management Procedures (MPs)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="customized-management-procedures-mps.html"><a href="customized-management-procedures-mps.html#mp-1"><i class="fa fa-check"></i><b>4.1</b> MP 1</a></li>
<li class="chapter" data-level="4.2" data-path="customized-management-procedures-mps.html"><a href="customized-management-procedures-mps.html#mp-2"><i class="fa fa-check"></i><b>4.2</b> MP 2</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-closed-loop-simulation.html"><a href="the-closed-loop-simulation.html"><i class="fa fa-check"></i><b>5</b> The Closed Loop Simulation</a></li>
<li class="chapter" data-level="6" data-path="exploring-the-simulation-outputs.html"><a href="exploring-the-simulation-outputs.html"><i class="fa fa-check"></i><b>6</b> Exploring the Simulation Outputs</a></li>
<li class="chapter" data-level="7" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>7</b> Examples</a>
<ul>
<li class="chapter" data-level="7.1" data-path="examples.html"><a href="examples.html#honeycomb-grouper-example"><i class="fa fa-check"></i><b>7.1</b> Honeycomb grouper example</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="examples.html"><a href="examples.html#populationg-the-life-history"><i class="fa fa-check"></i><b>7.1.1</b> Populationg the life history</a></li>
<li class="chapter" data-level="7.1.2" data-path="examples.html"><a href="examples.html#populating-the-fishery-history"><i class="fa fa-check"></i><b>7.1.2</b> Populating the fishery history</a></li>
<li class="chapter" data-level="7.1.3" data-path="examples.html"><a href="examples.html#populating-the-time-and-area-parameters"><i class="fa fa-check"></i><b>7.1.3</b> Populating the time and area parameters</a></li>
<li class="chapter" data-level="7.1.4" data-path="examples.html"><a href="examples.html#exploring-the-paramaterization-of-the-om-so-far"><i class="fa fa-check"></i><b>7.1.4</b> Exploring the paramaterization of the OM so far</a></li>
<li class="chapter" data-level="7.1.5" data-path="examples.html"><a href="examples.html#including-stochasticity"><i class="fa fa-check"></i><b>7.1.5</b> Including stochasticity</a></li>
<li class="chapter" data-level="7.1.6" data-path="examples.html"><a href="examples.html#fishery-projections-1"><i class="fa fa-check"></i><b>7.1.6</b> Fishery projections</a></li>
<li class="chapter" data-level="7.1.7" data-path="examples.html"><a href="examples.html#the-management-strategy-1"><i class="fa fa-check"></i><b>7.1.7</b> The management strategy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">FishSimGTG: Population dynamics simulation framework</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="om" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Mathematical description of the Operating model (OM)<a href="om.html#om" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>    An operating model is a mathematical representation of the biology of a fish stock and the fishery that operates on the fish stock. The operating model should also include a sub-model that reflects how the management regulations are implemented and are adhered to in practice <span class="citation">(<a href="#ref-punt_management_2016">Punt et al. 2016</a>)</span>.</p>
<div id="population-dynamics" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Population dynamics<a href="om.html#population-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>    The operating model (OM) describes the age-structured population dynamics of a fish population or stock. Population dynamics are specified for a single sex, with dynamics operating on an annual time step, and allowing for migration between multiple areas. Abundance at age, <span class="math inline">\(a\)</span>, at the start of year <span class="math inline">\(t\)</span>, and in area <span class="math inline">\(i\)</span>, <span class="math inline">\(N_{a,t,i}\)</span> is given by:</p>
<p><span class="math display">\[
N_{0,t,i} = \rho_i R_t, \tag{eq. 1} \label{eq:first}
\]</span></p>
<p>And,</p>
<p><span class="math display">\[
N_{a+1,t+1,i} = S_{a,t,i} \left(N_{a,t,i}\theta_{i \rightarrow i}+\sum_{j \neq i} N_{a,t,j}\theta_{j \rightarrow i}\right). \tag{eq. 2} \label{eq:second}
\]</span></p>
<p>Equation <span class="math inline">\(\ref{eq:first}\)</span> is the fraction, <span class="math inline">\(\rho_i\)</span>, of total age-0 recruits, <span class="math inline">\(R_t\)</span>, at the start of the year that are added to area <span class="math inline">\(i\)</span>. In equation <span class="math inline">\(\ref{eq:second}\)</span>, the term in parenthesis describes the fraction of abundance-at-age that does not emigrate from area <span class="math inline">\(i\)</span>, <span class="math inline">\(\theta_{i \rightarrow i}\)</span>, plus the summation of abundance-at-age arriving from all other areas, <span class="math inline">\(j\)</span>, <span class="math inline">\(\theta_{a,j \rightarrow i}\)</span>. In this form, Equation <span class="math inline">\(\ref{eq:second}\)</span> specifies migration to occur at the beginning of the year, followed by survival, <span class="math inline">\(S_{a,t,i}\)</span>, from age <span class="math inline">\(a\)</span> to age <span class="math inline">\(a+1\)</span>.<br />
    The multi-area model is implemented in matrix form, analogous to a Leslie matrix, as described by <span class="citation">Quinn and Deriso (<a href="#ref-quinn_quantitative_1999">1999</a>)</span>. For brevity, the matrix form is summarized using a two-area example, reflecting the description provided by <span class="citation">Quinn and Deriso (<a href="#ref-quinn_quantitative_1999">1999</a>)</span>, but note that the operating model is generalized as a multi-area model. To account for migration between two areas, <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, abundance-at-age in the matrix form is:</p>
<p><span class="math display">\[
\mathbf{N}_{t+1} = \mathbf{P}\mathbf{N}_t, \tag{eq. 3} \label{eq:third}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{N}_t\)</span> for ages 0 to maximum age, <span class="math inline">\(A\)</span>, is written:</p>
<p><span class="math display">\[
\mathbf{N}_t =
\begin{pmatrix}
\mathbf{N}_{t,i} \\
\mathbf{N}_{t,j}
\end{pmatrix}
=
\begin{pmatrix}
N_{1,t,i} \\
\vdots \\
N_{A,t,i} \\
N_{1,t,j} \\
\vdots \\
N_{A,t,j}
\end{pmatrix}.
\tag{eq. 4} \label{eq:fourth}
\]</span></p>
<p>The projection matrix <span class="math inline">\(\mathbf{P}\)</span> is</p>
<p><span class="math display">\[
\mathbf{P} = \begin{pmatrix}
P_{i,j} &amp; P_{i,j} \\
P_{i,j} &amp; P_{i,j}
\end{pmatrix}, \tag{eq. 5} \label{eq:fifth}
\]</span></p>
<p>where each element, <span class="math inline">\(P_{i,j}\)</span>, is a matrix that accounts for movement and survival. The matrices, <span class="math inline">\(P_{i,j}\)</span>, are populated as:</p>
<p><span class="math display">\[
P_{i,i} = \begin{pmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
S_{1,t,i}\theta_{1,i\rightarrow i} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; S_{2,t,i}\theta_{2,i\rightarrow i} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; \ddots &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; S_{A-1,t,i}\theta_{A-1,i\rightarrow i} &amp; S_{A,t,i}\theta_{A,i\rightarrow i}
\end{pmatrix}, \tag{eq. 6} \label{eq:sixth}
\]</span></p>
<p>And,</p>
<p><span class="math display">\[
P_{i,j} = \begin{pmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
S_{1,t,i}\theta_{1,j\rightarrow i} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; S_{2,t,i}\theta_{2,j\rightarrow i} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; \ddots &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; S_{A-1,t,i}\theta_{A-1,j\rightarrow i} &amp; S_{A,t,i}\theta_{A,j\rightarrow i}
\end{pmatrix}. \tag{eq. 7} \label{eq:seventh}
\]</span></p>
<p>The operating model specifies a plus group in position (<span class="math inline">\(A,A\)</span>).<br />
    Total annual recruitment is calculated according to the <span class="citation">Beverton and Holt (<a href="#ref-beverton_dynamics_1957">1957</a>)</span> stock-recruitment function, which is parameterized using steepness <span class="math inline">\((h)\)</span>:</p>
<p><span class="math display">\[
R_t = \left(\frac{0.8R_0hB_t}{0.2B_0\left(1-h\right) + \left(h-0.2\right)B_t}\right) \exp{\left(d_t - \frac{{\sigma_R}^2}{2}\right)},  \tag{eq. 8} \label{eq:eighth}
\]</span></p>
<p>where <span class="math inline">\(B_0\)</span> is unfished reproductive output, <span class="math inline">\(R_0\)</span> is unfished recruitment, and <span class="math inline">\(d\)</span> is the annual recruitment deviation, where <span class="math inline">\(\sigma_R\)</span> is recruitment variability. Annual reproductive output, <span class="math inline">\(B_t\)</span>, is aggregate output (e.g., spawning biomass) for all areas combined, excluding any reproductive contribution of age-0 recruits created at the beginning of the year. Calculated total recruits are distributed to each area in proportion to the area-specific fraction, <span class="math inline">\(\rho_i\)</span>, with <span class="math inline">\(\sum\rho_i=1\)</span>. An overall recruitment deviation signal (e.g., a surrogate for an environmental condition affecting recruitment success) is generated from a normal distribution with mean zero and standard deviation, <span class="math inline">\(\sigma_R\)</span>, (e.g., <span class="math inline">\(\sigma_R\)</span> = 0.6). Inter-annual autocorrelation in recruitment can be specified, producing 1-year lagged correlation in log-scale recruitment deviations.</p>
</div>
<div id="life-history" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Life history<a href="om.html#life-history" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>    Length is calculated at the start of the year according to the von Bertalanffy growth curve, where <span class="math inline">\(L_\infty\)</span> is asymptotic length, <span class="math inline">\(K\)</span> is the growth rate, and parameter <span class="math inline">\(t_0\)</span>:</p>
<p><span class="math display">\[
L_a = L_\infty \left(1- \exp{\left(-K\left(a - t_0\right)\right)}\right). \tag{eq. 9} \label{eq:nineth}
\]</span></p>
<p>Weight-at-age, <span class="math inline">\(W_a\)</span>, with parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> is specified as an exponential function:</p>
<p><span class="math display">\[
W_a=\alpha L_a^\beta. \tag{eq. 10} \label{eq:tenth}
\]</span></p>
<p>Maturation follows a logistic function with parameters <span class="math inline">\(L50\)</span> and <span class="math inline">\(L95\)</span>, reflecting the lengths at which 50% and 95% of the population are mature, respectively. Optionally, species can be specified as protogynous hermaphroditic species, with proportion of male in the population following an increasing logistic function with parameters <span class="math inline">\(H50\)</span> and <span class="math inline">\(H95\)</span>, reflecting the lengths at which 50% and 95% of the population are male, respectively. For gonochoristic species, a 50:50 sex ratio is assumed at all lengths or ages. Total reproductive output, <span class="math inline">\(B_t\)</span>, is a summation of mature biomass across age classes and areas:</p>
<p><span class="math display">\[
B_t=\sum_{i}\sum_{a}{N_{a,t,i}W_a\mathit{mat}_a{propFemale}_a}, \tag{eq. 11} \label{eq:eleventh}
\]</span></p>
<p>Where <span class="math inline">\(propFemale\)</span> is proportion of the population female at age, with a value of 0.5 for all ages for gonochoristic species and values of 1-<span class="math inline">\(propMale_a\)</span> when sexual transition from female to male is specified.<br />
    Both natural mortality and maximum age can be specified. When maximum age, <span class="math inline">\(A\)</span>, is specified, this quantity is used in constructing abundance matrices. Maximum must be equal to or greater than 2, as this modeling framework is not well suiting to species with very fast life histories. When maximum age is not specified, the age to which 1% the population survives in an unfished system is used to calculate maximum age, using the formula:</p>
<p><span class="math display">\[
A=\ ceiling\left(-\frac{\log{\left(0.01\right)}}{M}\right) \tag{eq. 12} \label{eq:twelftth}
\]</span></p>
<p>Uncertainty in life history can be accounted for by specifying parameter ranges, rather than point estimates for most life history parameters. Each iteration will produce a unique set of life history parameters based on independent draws from uniform distributions that correspond to the specified minimum and maximum for each parameter.</p>
</div>
<div id="initial-conditions" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Initial conditions<a href="om.html#initial-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>    This modeling framework was developed to create historical dynamics of fish stocks that begin (i.e., year 0) in a fished state, meaning that fishing mortality (and consequently fishing effort) are greater than zero in the initial equilibrium year (year 0). Thus, the modeling framework is not suitable for circumstances for initializing the model in an unfished or pre-fishing state. Accordingly, initial depletion should always be less than 1.0. As the state of depletion of each species may be uncertain, initial depletion is implemented as a range of plausible values, producing slightly different values for each iteration. At the beginning of each iteration, initial depletion (i.e., initial spawning biomass relative to unfished spawning biomass) based on a draw from a uniform distribution with a specified minimum and maximum. An alternative formulation is available in that initial ‘depletion’ can instead be specified as initial SPR. Subsequently, the population is initialized as follows. First, equilibrium age-structure is determined for the given depletion level assuming area-specific recruitment fractions, <span class="math inline">\(\rho_i\)</span>, but no movement, resulting in an equilibrium fishing mortality rate and equilibrium abundance scaled relative to the specified <span class="math inline">\(R_0\)</span>. Second, a burn-in period is used to project the population forward for <span class="math inline">\(A\)</span>x4 years at the estimated equilibrium fishing mortality rate, allowing a stable age distribution between areas to be obtained through migration. Elements that account for uncertainty (initial depletion, life history, selectivity, and annual recruitment deviations) are generated ahead of simulation runs and retained to ensure that each management strategy can be subject to the same sets of stochastic elements, and thus not subject to chance differences in draws from sampling distributions.</p>
</div>
<div id="fishery-dynamics" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Fishery dynamics<a href="om.html#fishery-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>    Survival (<span class="math inline">\(S\)</span>) consists of natural mortality (<span class="math inline">\(M\)</span> year<span class="math inline">\(^{-1}\)</span>, fishing mortality (<span class="math inline">\(F\)</span> year<span class="math inline">\(^{-1}\)</span>):</p>
<p><span class="math display">\[
S_{a,t,i}=exp{\left(-M-{\mathit{Removal}}_aF_{t,i}\right)}, \tag{eq. 13} \label{eq:thirteenth}
\]</span></p>
<p>where <span class="math inline">\(Removal\)</span> is a component of fishery selectivity and is covered in a subsequent section.<br />
Landings in numbers (<span class="math inline">\(C^{N}\)</span> is:</p>
<p><span class="math display">\[
C_{a,t,i}^N=\frac{{\mathit{Keep}}_aF_{t,i}}{\left(M_s+{\mathit{Removal}}_aF_{t,i}\right)}\left(1-S_{a,t,i}\right)N_{a,t,i}, \tag{eq. 14} \label{eq:fourteenth}
\]</span></p>
<p>and <span class="math inline">\(keep\)</span> is a component of fishery selectivity. Landings in weight (<span class="math inline">\(C^B\)</span>) is:</p>
<p><span class="math display">\[
C_{a,t,i}^B=C_{a,t,i}^NW_a \tag{eq. 15} \label{eq:fifteenth}
\]</span></p>
<p>Fishery selectivity is defined as follows. Vulnerability to the fishing gear, <span class="math inline">\(Vul\)</span>, is currently includes lognormal selectivity (parameterized for gillnet parameter inputs) and logistic selectivity, with input parameters <span class="math inline">\(SL50\)</span> and <span class="math inline">\(SL95\)</span>, reflecting the lengths at which 50% and 95% of the population are mature vulnerable to the gear, respectively. Retention, <span class="math inline">\(Ret\)</span>, can be specified as ‘full’, resulting in full retention across all vulnerable size classes, ‘logistic’ or ‘slot limit’. Additionally, the maximum level of retention (e.g., a quantity between 0 and 1) can be specified for any of the above stated retention types. Finally, a discard mortality proportion, <span class="math inline">\(D\)</span>, (e.g. quantity between 0 and 1) can be specified to affect the fate of discards. These inputs are used in calculating the following components of fishery selectivity.</p>
<p><span class="math inline">\(Keep\)</span> - <em>the resulting probability of being landed</em>
<span class="math display">\[
Keep_a=Vul_aRet_a \tag{eq. 16} \label{eq:sixteenth}
\]</span></p>
<p><span class="math inline">\(Dead\,discards\)</span> - <em>deaths resulting from vulnerable abundance that is not retained</em>
<span class="math display">\[
Dead\,discards_a=Vul_a(1-Ret_a)D \tag{eq. 17} \label{eq:seventeenth}
\]</span></p>
<p><span class="math inline">\(Total\,removals\)</span> – <em>probability of removal from the population via landing or discard</em>
<span class="math display">\[
Removal_a=Vul_a(Ret_a+(1-Ret_a)D) \tag{eq. 18} \label{eq:eighteenth}
\]</span></p>
<p>Uncertainty in vulnerability and retention can be accounted for by specifying parameter ranges, rather than point estimates. Each iteration will produce a unique selectivity and/or retention characteristics based on independent draws from uniform distributions that correspond to the specified minimum and maximum for each parameter.</p>
</div>
<div id="observation-and-monitoring" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Observation and monitoring<a href="om.html#observation-and-monitoring" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>    Depending on the specific application of the model, an observation model may be required. This requirement is driven by whether a harvest control rule is used in decision-making. That is, whether some form of data collection will inform year-to-year adjustments in a total allowable catch or total fishery effort. If so, then simulation of the data observation processes (including imperfect observation) is required. Observation models tend to be tailored to the type of data collection program that is in place. This component should be developed as needed for each unique application.</p>
</div>
<div id="growth-type-group" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Growth-type group<a href="om.html#growth-type-group" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To account for individual variation in growth trajectories, the population is divided into growth-type groups (GTGs) or cohorts <span class="citation">Hordyk et al. (<a href="#ref-hordyk_simple_2016">2016</a>)</span>. GTGs describe the variation in growth of a fish population through the creation of <span class="math inline">\(G\)</span> groups and with dimensions indexed <span class="math inline">\(g=1,2…G\)</span>. Each group differs in terms of its <span class="math inline">\(L_\infty\)</span>. Given a mean value, <span class="math inline">\(\bar{L}_\infty\)</span> and a standard deviation (calculated as a coefficient of variation, <span class="math inline">\(CV_L\)</span> times <span class="math inline">\(\bar{L}_\infty\)</span>), the range of <span class="math inline">\(L_\infty\)</span> ± two standard deviations is divided into <span class="math inline">\(G\)</span> equal increments. A default value of <span class="math inline">\(CV_L\)</span> = 0.1 and <span class="math inline">\(G\)</span> = 13 groups, results in <span class="math inline">\(g\)</span> = 7 representing <span class="math inline">\(\bar{L}_\infty\)</span>. Cohort size assigned to each group is determined by distributing a fraction of annual recruits in each group, <span class="math inline">\(p\)</span>, where <span class="math inline">\(\sum{p}=1\)</span>. Vector <span class="math inline">\(p\)</span> is determined as proportional to the <span class="math inline">\(G\)</span> increments in <span class="math inline">\(L_\infty\)</span> along the probability density function of a normal distribution with mean <span class="math inline">\(\bar{L}_\infty\)</span> and variance <span class="math inline">\(\left(CV_L{\bar{L}}_\infty\right)^2\)</span>. Functionality is also included such that if <span class="math inline">\(G\)</span> = 1, the model collapses to a simpler age-based model.</p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-beverton_dynamics_1957" class="csl-entry">
Beverton, R. J. H., and S. J. Holt. 1957. <em>On the <span>Dynamics</span> of <span>Exploited</span> <span>Fish</span> <span>Populations</span></em>. London: Her Majesty’s Stationery Office.
</div>
<div id="ref-hordyk_simple_2016" class="csl-entry">
Hordyk, Adrian R., Kotaro Ono, Jeremy D. Prince, and Carl J. Walters. 2016. <span>“A Simple Length-Structured Model Based on Life History Ratios and Incorporating Size-Dependent Selectivity: Application to Spawning Potential Ratios for Data-Poor Stocks.”</span> <em>Canadian Journal of Fisheries and Aquatic Sciences</em> 73 (12): 1787–99. <a href="https://doi.org/10.1139/cjfas-2015-0422">https://doi.org/10.1139/cjfas-2015-0422</a>.
</div>
<div id="ref-punt_management_2016" class="csl-entry">
Punt, André E., Doug S. Butterworth, Carryn L. de Moor, José A. A. De Oliveira, and Malcolm Haddon. 2016. <span>“Management Strategy Evaluation: <span>Best</span> Practices.”</span> <em>Fish and Fisheries</em> 17 (2): 303–34. <a href="https://doi.org/10.1111/faf.12104">https://doi.org/10.1111/faf.12104</a>.
</div>
<div id="ref-quinn_quantitative_1999" class="csl-entry">
Quinn, Terrance J, and Richard B Deriso. 1999. <em>Quantitative Fish Dynamics</em>. oxford university Press.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="om-pop.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="customized-management-procedures-mps.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-OM.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
