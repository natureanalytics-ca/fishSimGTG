geom_point(size=1) +
geom_text_repel(data=totalSSB,
aes(catchB_median, SSB_median, label = nm),
fontface = 'bold', color="cornflowerblue",
box.padding = unit(0.5, "lines"),
point.padding = unit(0, "lines"),
show.legend = FALSE,
max.overlaps = 25
) +
ylab(paste("Relative biomass after", proYear, "years")) +
xlab(paste("Relative catch weight after", proYear, "years")) +
theme_classic() +
theme(strip.text.x=element_text(colour = "black", size=8, face="bold"),
strip.text.y=element_text(colour = "black", size=8, face="bold"),
strip.background = element_rect(fill ="lightgrey"),
axis.text=element_text(size=6),
panel.border = element_rect(linetype = "solid", colour = "black", fill=NA))+
facet_wrap(~fct, ncol=2)
ggsave(filename = paste0(wd, "/Relative_SSB_catch.png"), device = "png", dpi = dpi, width = 6, height = (3*NROW(unique(totalSSB$fct))/2), units = "in")
#library(fishSimGTG)
devtools::load_all()
library(here)
relSSBScatter(wd =  here("data-test", "Kala"),
fileName = list(
"Higher_option1",
"Higher_option2",
"Higher_option3",
"Lower_option1",
"Lower_option2",
"Lower_option3"
),
facetName = c(as.list(rep("Higher biomass scenario", 3)), as.list(rep("Lower biomass scenario", 3))),
proYear = 10)
ggplot(totalSSB, aes(catchB_median, SSB_median)) +
geom_vline(xintercept = 1, color="lightgrey") +
geom_hline(yintercept = 1, colour="lightgrey") +
geom_point(size=1) +
geom_text_repel(data=totalSSB,
aes(catchB_median, SSB_median, label = nm),
fontface = 'bold', color="cornflowerblue",
size=4,
box.padding = unit(0.5, "lines"),
point.padding = unit(0, "lines"),
show.legend = FALSE,
max.overlaps = 25
) +
ylab(paste("Relative biomass after", proYear, "years")) +
xlab(paste("Relative catch weight after", proYear, "years")) +
theme_classic() +
theme(strip.text.x=element_text(colour = "black", size=8, face="bold"),
strip.text.y=element_text(colour = "black", size=8, face="bold"),
strip.background = element_rect(fill ="lightgrey"),
axis.text=element_text(size=6),
panel.border = element_rect(linetype = "solid", colour = "black", fill=NA))+
facet_wrap(~fct, ncol=2)
ggplot(totalSSB, aes(catchB_median, SSB_median)) +
geom_vline(xintercept = 1, color="lightgrey") +
geom_hline(yintercept = 1, colour="lightgrey") +
geom_point(size=1) +
geom_text_repel(data=totalSSB,
aes(catchB_median, SSB_median, label = nm),
fontface = 'bold', color="cornflowerblue",
size=2,
box.padding = unit(0.5, "lines"),
point.padding = unit(0, "lines"),
show.legend = FALSE,
max.overlaps = 25
) +
ylab(paste("Relative biomass after", proYear, "years")) +
xlab(paste("Relative catch weight after", proYear, "years")) +
theme_classic() +
theme(strip.text.x=element_text(colour = "black", size=8, face="bold"),
strip.text.y=element_text(colour = "black", size=8, face="bold"),
strip.background = element_rect(fill ="lightgrey"),
axis.text=element_text(size=6),
panel.border = element_rect(linetype = "solid", colour = "black", fill=NA))+
facet_wrap(~fct, ncol=2)
ggplot(totalSSB, aes(catchB_median, SSB_median)) +
geom_vline(xintercept = 1, color="lightgrey") +
geom_hline(yintercept = 1, colour="lightgrey") +
geom_point(size=1) +
geom_text_repel(data=totalSSB,
aes(catchB_median, SSB_median, label = nm),
fontface = 'bold', color="cornflowerblue",
size=2,
box.padding = unit(0.5, "lines"),
point.padding = unit(0, "lines"),
show.legend = FALSE,
max.overlaps = 25
) +
ylab(paste("Relative biomass after", proYear, "years")) +
xlab(paste("Relative catch weight after", proYear, "years")) +
theme_classic() +
theme(strip.text.x=element_text(colour = "black", size=8, face="bold"),
strip.text.y=element_text(colour = "black", size=8, face="bold"),
strip.background = element_rect(fill ="lightgrey"),
axis.text=element_text(size=6),
panel.border = element_rect(linetype = "solid", colour = "black", fill=NA))+
facet_wrap(~fct, ncol=2)
ggsave(filename = paste0(wd, "/Relative_SSB_catch.png"), device = "png", dpi = dpi, width = 6, height = (3*NROW(unique(totalSSB$fct))/2), units = "in")
?geom_text_repel
ggplot(totalSSB, aes(catchB_median, SSB_median)) +
geom_vline(xintercept = 1, color="lightgrey") +
geom_hline(yintercept = 1, colour="lightgrey") +
geom_point(size=1) +
geom_text_repel(data=totalSSB,
aes(catchB_median, SSB_median, label = nm),
fontface = 'bold',
color="cornflowerblue",
size=2,
segment.size = 2,
box.padding = unit(0.5, "lines"),
point.padding = unit(0, "lines"),
show.legend = FALSE,
max.overlaps = 25
) +
ylab(paste("Relative biomass after", proYear, "years")) +
xlab(paste("Relative catch weight after", proYear, "years")) +
theme_classic() +
theme(strip.text.x=element_text(colour = "black", size=8, face="bold"),
strip.text.y=element_text(colour = "black", size=8, face="bold"),
strip.background = element_rect(fill ="lightgrey"),
axis.text=element_text(size=6),
panel.border = element_rect(linetype = "solid", colour = "black", fill=NA))+
facet_wrap(~fct, ncol=2)
ggsave(filename = paste0(wd, "/Relative_SSB_catch.png"), device = "png", dpi = dpi, width = 6, height = (3*NROW(unique(totalSSB$fct))/2), units = "in")
ggplot(totalSSB, aes(catchB_median, SSB_median)) +
geom_vline(xintercept = 1, color="lightgrey") +
geom_hline(yintercept = 1, colour="lightgrey") +
geom_point(size=1) +
geom_text_repel(data=totalSSB,
aes(catchB_median, SSB_median, label = nm),
fontface = 'bold',
color="cornflowerblue",
size=2,
segment.size = 0.5,
box.padding = unit(0.5, "lines"),
point.padding = unit(0, "lines"),
show.legend = FALSE,
max.overlaps = 25
) +
ylab(paste("Relative biomass after", proYear, "years")) +
xlab(paste("Relative catch weight after", proYear, "years")) +
theme_classic() +
theme(strip.text.x=element_text(colour = "black", size=8, face="bold"),
strip.text.y=element_text(colour = "black", size=8, face="bold"),
strip.background = element_rect(fill ="lightgrey"),
axis.text=element_text(size=6),
panel.border = element_rect(linetype = "solid", colour = "black", fill=NA))+
facet_wrap(~fct, ncol=2)
ggsave(filename = paste0(wd, "/Relative_SSB_catch.png"), device = "png", dpi = dpi, width = 6, height = (3*NROW(unique(totalSSB$fct))/2), units = "in")
ggplot(totalSSB, aes(catchB_median, SSB_median)) +
geom_vline(xintercept = 1, color="lightgrey") +
geom_hline(yintercept = 1, colour="lightgrey") +
geom_point(size=1) +
geom_text_repel(data=totalSSB,
aes(catchB_median, SSB_median, label = nm),
fontface = 'bold',
color="cornflowerblue",
size=2,
segment.size = 0.1,
segment.color = "black",
box.padding = unit(0.5, "lines"),
point.padding = unit(0, "lines"),
show.legend = FALSE,
max.overlaps = 25
) +
ylab(paste("Relative biomass after", proYear, "years")) +
xlab(paste("Relative catch weight after", proYear, "years")) +
theme_classic() +
theme(strip.text.x=element_text(colour = "black", size=8, face="bold"),
strip.text.y=element_text(colour = "black", size=8, face="bold"),
strip.background = element_rect(fill ="lightgrey"),
axis.text=element_text(size=6),
panel.border = element_rect(linetype = "solid", colour = "black", fill=NA))+
facet_wrap(~fct, ncol=2)
ggsave(filename = paste0(wd, "/Relative_SSB_catch.png"), device = "png", dpi = dpi, width = 6, height = (3*NROW(unique(totalSSB$fct))/2), units = "in")
#Total relative SSB
ggplot(totalSSB, aes(catchB_median, SSB_median)) +
geom_vline(xintercept = 1, color="lightgrey") +
geom_hline(yintercept = 1, colour="lightgrey") +
geom_point(size=1) +
geom_label_repel(data=totalSSB,
aes(catchB_median, SSB_median, label = nm),
fontface = 'bold',
color="cornflowerblue",
size=2,
segment.size = 0.1,
segment.color = "black",
box.padding = unit(0.5, "lines"),
point.padding = unit(0, "lines"),
show.legend = FALSE,
max.overlaps = 25
) +
ylab(paste("Relative biomass after", proYear, "years")) +
xlab(paste("Relative catch weight after", proYear, "years")) +
theme_classic() +
theme(strip.text.x=element_text(colour = "black", size=8, face="bold"),
strip.text.y=element_text(colour = "black", size=8, face="bold"),
strip.background = element_rect(fill ="lightgrey"),
axis.text=element_text(size=6),
panel.border = element_rect(linetype = "solid", colour = "black", fill=NA))+
facet_wrap(~fct, ncol=2)
ggsave(filename = paste0(wd, "/Relative_SSB_catch.png"), device = "png", dpi = dpi, width = 6, height = (3*NROW(unique(totalSSB$fct))/2), units = "in")
#Area-specific
ggplot(areaSSB, aes(catchB_median, SSB_median)) +
geom_vline(xintercept = 1, color="lightgrey") +
geom_hline(yintercept = 1, colour="lightgrey") +
geom_point(size=1) +
geom_label_repel(data=totalSSB,
aes(catchB_median, SSB_median, label = nm),
fontface = 'bold',
color="cornflowerblue",
size=2,
segment.size = 0.1,
segment.color = "black",
box.padding = unit(0.5, "lines"),
point.padding = unit(0, "lines"),
show.legend = FALSE,
max.overlaps = 25
) +
ylab(paste("Relative biomass after", proYear, "years")) +
xlab(paste("Relative catch weight after", proYear, "years")) +
theme_classic() +
theme(strip.text.x=element_text(colour = "black", size=8, face="bold"),
strip.text.y=element_text(colour = "black", size=8, face="bold"),
strip.background = element_rect(fill ="lightgrey"),
axis.text=element_text(size=6),
panel.border = element_rect(linetype = "solid", colour = "black", fill=NA))+
facet_wrap(~fct + area, ncol=data$TimeAreaObj@areas)
ggsave(filename = paste0(wd, "/Relative_SSB_catch_byArea.png"), device = "png", width = 6, height = (3*NROW(unique(totalSSB$fct))*data$TimeAreaObj@areas/2), units = "in", dpi = dpi)
33*15
12*15
6*15
6*15
40/15
40/10
120/12
12*12
88/1.24
28*110
280*110
55*2.5
6*132
6*12
12*10*125
30*121
30*125
16720*2
33440-25000
40*125
240*110
devtools::load_all()
relSSBScatter(wd =  here("data-test", "Kala"),
fileName = list(
"Higher_option1",
"Higher_option2",
"Higher_option3",
"Lower_option1",
"Lower_option2",
"Lower_option3"
),
facetName = c(as.list(rep("Higher biomass scenario", 3)), as.list(rep("Lower biomass scenario", 3))),
proYear = 10)
devtools::load_all()
relSSBScatter(wd =  here("data-test", "Kala"),
fileName = list(
"Higher_option1",
"Higher_option2",
"Higher_option3",
"Lower_option1",
"Lower_option2",
"Lower_option3"
),
facetName = c(as.list(rep("Higher biomass scenario", 3)), as.list(rep("Lower biomass scenario", 3))),
proYear = 10)
facetName = c(as.list(rep("Higher biomass scenario", 3)), as.list(rep("Lower biomass scenario", 3)))
facetName
unlist(facetName)
unique(unlist(facetName))
devtools::load_all()
relSSBScatter(wd =  here("data-test", "Kala"),
fileName = list(
"Higher_option1",
"Higher_option2",
"Higher_option3",
"Lower_option1",
"Lower_option2",
"Lower_option3"
),
facetName = c(as.list(rep("Higher biomass scenario", 3)), as.list(rep("Lower biomass scenario", 3))),
proYear = 10)
wd =  here("data-test", "Kala")
fileName = list(
"Higher_option1",
"Higher_option2",
"Higher_option3",
"Lower_option1",
"Lower_option2",
"Lower_option3"
)
facetName = c(as.list(rep("Higher biomass scenario", 3)), as.list(rep("Lower biomass scenario", 3)))
proYear = 10
totalSSB<-data.frame()
areaSSB<-data.frame()
for(i in 1:NROW(fileName)){
data<-readRDS(paste0(wd, "/", fileName[[i]],".rds"))
refYear<-1 + data$TimeAreaObj@historicalYears
getYear<-1 + data$TimeAreaObj@historicalYears + proYear
#Total relative SSB across areas
SSB_tmp<-sapply(1:data$TimeAreaObj@iterations, FUN=function(x){
sum(data$dynamics$SB[getYear,x,]) / sum(data$dynamics$SB[refYear,x,])
})
cat_tmp<-sapply(1:data$TimeAreaObj@iterations, FUN=function(x){
sum(data$dynamics$catchB[getYear,x,]) / sum(data$dynamics$catchB[refYear,x,])
})
totalSSB<-rbind(totalSSB, list(fct = facetName[[i]], nm = data$titleStrategy, SSB_median = median(SSB_tmp), catchB_median = median(cat_tmp)))
#Area-specific relative SSB
for(m in 1:data$TimeAreaObj@areas){
SSB_tmp<-sapply(1:data$TimeAreaObj@iterations, FUN=function(x){
data$dynamics$SB[getYear,x,m] / data$dynamics$SB[refYear,x,m]
})
cat_tmp<-sapply(1:data$TimeAreaObj@iterations, FUN=function(x){
data$dynamics$catchB[getYear,x,m] / data$dynamics$catchB[refYear,x,m]
})
areaSSB<-rbind(areaSSB, list(fct = facetName[[i]], nm = data$titleStrategy, area = paste("Area", m), SSB_median = median(SSB_tmp), catchB_median = median(cat_tmp)))
}
}
totalSSB
ggplot(totalSSB, aes(catchB_median, SSB_median)) +
geom_vline(xintercept = 1, color="lightgrey") +
geom_hline(yintercept = 1, colour="lightgrey") +
geom_point(size=1) +
geom_label_repel(data=totalSSB,
aes(catchB_median, SSB_median, label = nm),
fontface = 'bold',
color="cornflowerblue",
size=2,
segment.size = 0.1,
segment.color = "black",
box.padding = unit(0.5, "lines"),
point.padding = unit(0, "lines"),
show.legend = FALSE,
max.overlaps = 25
) +
ylab(paste("Relative biomass after", proYear, "years")) +
xlab(paste("Relative catch weight after", proYear, "years")) +
theme_classic() +
theme(strip.text.x=element_text(colour = "black", size=8, face="bold"),
strip.text.y=element_text(colour = "black", size=8, face="bold"),
strip.background = element_rect(fill ="lightgrey"),
axis.text=element_text(size=6),
panel.border = element_rect(linetype = "solid", colour = "black", fill=NA))+
facet_wrap(~fct, ncol=NROW(unique(unlist(~fct))))
fct
ggplot(totalSSB, aes(catchB_median, SSB_median)) +
geom_vline(xintercept = 1, color="lightgrey") +
geom_hline(yintercept = 1, colour="lightgrey") +
geom_point(size=1) +
geom_label_repel(data=totalSSB,
aes(catchB_median, SSB_median, label = nm),
fontface = 'bold',
color="cornflowerblue",
size=2,
segment.size = 0.1,
segment.color = "black",
box.padding = unit(0.5, "lines"),
point.padding = unit(0, "lines"),
show.legend = FALSE,
max.overlaps = 25
) +
ylab(paste("Relative biomass after", proYear, "years")) +
xlab(paste("Relative catch weight after", proYear, "years")) +
theme_classic() +
theme(strip.text.x=element_text(colour = "black", size=8, face="bold"),
strip.text.y=element_text(colour = "black", size=8, face="bold"),
strip.background = element_rect(fill ="lightgrey"),
axis.text=element_text(size=6),
panel.border = element_rect(linetype = "solid", colour = "black", fill=NA))+
facet_wrap(~fct, ncol=NROW(unique(totalSSB$fctfct)))
ggplot(totalSSB, aes(catchB_median, SSB_median)) +
geom_vline(xintercept = 1, color="lightgrey") +
geom_hline(yintercept = 1, colour="lightgrey") +
geom_point(size=1) +
geom_label_repel(data=totalSSB,
aes(catchB_median, SSB_median, label = nm),
fontface = 'bold',
color="cornflowerblue",
size=2,
segment.size = 0.1,
segment.color = "black",
box.padding = unit(0.5, "lines"),
point.padding = unit(0, "lines"),
show.legend = FALSE,
max.overlaps = 25
) +
ylab(paste("Relative biomass after", proYear, "years")) +
xlab(paste("Relative catch weight after", proYear, "years")) +
theme_classic() +
theme(strip.text.x=element_text(colour = "black", size=8, face="bold"),
strip.text.y=element_text(colour = "black", size=8, face="bold"),
strip.background = element_rect(fill ="lightgrey"),
axis.text=element_text(size=6),
panel.border = element_rect(linetype = "solid", colour = "black", fill=NA))+
facet_wrap(~fct, ncol=NROW(unique(totalSSB$fct)))
devtools::load_all()
relSSBScatter(wd =  here("data-test", "Kala"),
fileName = list(
"Higher_option1",
"Higher_option2",
"Higher_option3",
"Lower_option1",
"Lower_option2",
"Lower_option3",
"Higher_option1",
"Higher_option2",
"Higher_option3"
),
facetName = c(as.list(rep("Higher biomass scenario", 3)), as.list(rep("Lower biomass scenario", 3)), as.list(rep("Other biomass scenario", 3))),
proYear = 10)
#library(fishSimGTG)
devtools::load_all()
library(here)
#-----------------------------------------
#Kole
#-----------------------------------------
LifeHistoryObj <- new("LifeHistory")
LifeHistoryObj@title<-"Kole"
LifeHistoryObj@speciesName<-"Ctenochaetus strigosus"
LifeHistoryObj@Linf<-17.7
LifeHistoryObj@K<-0.423
LifeHistoryObj@t0<- -0.51
LifeHistoryObj@L50<-8.4
LifeHistoryObj@L95<-8.4*1.15
LifeHistoryObj@M<-0.08
LifeHistoryObj@L_type<-"FL"
LifeHistoryObj@L_units<-"cm"
LifeHistoryObj@LW_A<-0.046
LifeHistoryObj@LW_B<-2.85
LifeHistoryObj@Steep<-0.54
LifeHistoryObj@recSD<-0 #Run with no rec var'n to see deterministic trends
HistFisheryObj<-new("Fishery")
HistFisheryObj@title<-"Test"
HistFisheryObj@vulType<-"logistic"
HistFisheryObj@vulParams<-c(10.2,10.3) #Approx. knife edge
HistFisheryObj@retType<-"full"
HistFisheryObj@retMax <- 1
HistFisheryObj@Dmort <- 0
TimeAreaObj<-new("TimeArea")
TimeAreaObj@title = "Test"
TimeAreaObj@gtg = 13
TimeAreaObj@areas = 2
TimeAreaObj@recArea = c(0.99, 0.01)
TimeAreaObj@iterations = 10
TimeAreaObj@historicalYears = 10
TimeAreaObj@historicalBio = 0.5
TimeAreaObj@historicalBioType = "relB"
TimeAreaObj@move <- matrix(c(1,0, 0,1), nrow=2, ncol=2, byrow=FALSE)
TimeAreaObj@historicalEffort<-matrix(1:1, nrow = 10, ncol = 2, byrow = FALSE)
#------------------
#Higher SSB Scenario
#-----------------
StochasticObj<-new("Stochastic")
StochasticObj@historicalBio = c(0.3, 0.6)
StochasticObj@historicalCPUE = c(7,11)
StochasticObj@historicalCPUEType = "vulN"
ProFisheryObj<-new("Fishery")
ProFisheryObj@title<-"Test"
ProFisheryObj@vulType<-"logistic"
ProFisheryObj@vulParams<-c(10.2,10.3)
ProFisheryObj@retType<-"full"
ProFisheryObj@retMax <- 1
ProFisheryObj@Dmort <- 0
StrategyObj <- new("Strategy")
StrategyObj@projectionYears <- 50
StrategyObj@projectionName<-"projectionStrategy"
StrategyObj@projectionParams<-list(bag = c(5, 5), effort = matrix(1:1, nrow=50, ncol=2, byrow = FALSE))
#Batch processing - 3 management strategies
stateLmin<-c(10.2, 12.7,  12.7)
stateBag<-c(20, -99, 20)
fileLabel<-c("Higher_option1", "Higher_option2", "Higher_option3")
projectionLabel<-c("Bag 20", "Min size 5 inch", "Bag 20 & min size 5 inch")
relSSBScatter(wd =  here("data-test", "Kala"),
fileName = list(
"Higher_option1",
"Higher_option2",
"Higher_option3",
"Lower_option1",
"Lower_option2",
"Lower_option3",
"Higher_option1",
"Higher_option2",
"Higher_option3"
),
facetName = c(as.list(rep("Higher biomass scenario", 3)), as.list(rep("Lower biomass scenario", 3)), as.list(rep("Other biomass scenario", 3))),
proYear = 10)
?ggrepel
library(ggrepel)
relSSBScatter(wd =  here("data-test", "Kala"),
fileName = list(
"Higher_option1",
"Higher_option2",
"Higher_option3",
"Lower_option1",
"Lower_option2",
"Lower_option3",
"Higher_option1",
"Higher_option2",
"Higher_option3"
),
facetName = c(as.list(rep("Higher biomass scenario", 3)), as.list(rep("Lower biomass scenario", 3)), as.list(rep("Other biomass scenario", 3))),
proYear = 10)
